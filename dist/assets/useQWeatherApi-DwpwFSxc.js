var ye=Object.defineProperty;var $e=(o,i,n)=>i in o?ye(o,i,{enumerable:!0,configurable:!0,writable:!0,value:n}):o[i]=n;var ue=(o,i,n)=>($e(o,typeof i!="symbol"?i+"":i,n),n);import{ae as ge,af as ke,k as _e,e as B,d as me,S as Me,o as ee,b as Ce,a as K,B as we,f as ae,t as De,ag as Se,ah as be,Z as xe,c as ie,w as Z,u as Fe,N as ce,a4 as le,r as A,ai as Le,i as J,m as he}from"./index-DSpnpvE8.js";import{D as P,H as Oe,N as We,O as R,F as de,M as Te,G as je}from"./GeoApi-CXHV1UpF.js";var ve={exports:{}};(function(o,i){(function(n,s){o.exports=s()})(ge,function(){var n=1e3,s=6e4,h=36e5,w="millisecond",y="second",v="minute",C="hour",D="day",F="week",_="month",T="quarter",S="year",x="date",N="Invalid Date",L=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,te=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,re={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(u){var r=["th","st","nd","rd"],e=u%100;return"["+u+(r[(e-20)%10]||r[e]||r[0])+"]"}},Y=function(u,r,e){var a=String(u);return!a||a.length>=r?u:""+Array(r+1-a.length).join(e)+u},z={s:Y,z:function(u){var r=-u.utcOffset(),e=Math.abs(r),a=Math.floor(e/60),t=e%60;return(r<=0?"+":"-")+Y(a,2,"0")+":"+Y(t,2,"0")},m:function u(r,e){if(r.date()<e.date())return-u(e,r);var a=12*(e.year()-r.year())+(e.month()-r.month()),t=r.clone().add(a,_),c=e-t<0,l=r.clone().add(a+(c?-1:1),_);return+(-(a+(e-t)/(c?t-l:l-t))||0)},a:function(u){return u<0?Math.ceil(u)||0:Math.floor(u)},p:function(u){return{M:_,y:S,w:F,d:D,D:x,h:C,m:v,s:y,ms:w,Q:T}[u]||String(u||"").toLowerCase().replace(/s$/,"")},u:function(u){return u===void 0}},O="en",d={};d[O]=re;var ne="$isDayjsObject",se=function(u){return u instanceof V||!(!u||!u[ne])},Q=function u(r,e,a){var t;if(!r)return O;if(typeof r=="string"){var c=r.toLowerCase();d[c]&&(t=c),e&&(d[c]=e,t=c);var l=r.split("-");if(!t&&l.length>1)return u(l[0])}else{var p=r.name;d[p]=r,t=p}return!a&&t&&(O=t),t||!a&&O},$=function(u,r){if(se(u))return u.clone();var e=typeof r=="object"?r:{};return e.date=u,e.args=arguments,new V(e)},f=z;f.l=Q,f.i=se,f.w=function(u,r){return $(u,{locale:r.$L,utc:r.$u,x:r.$x,$offset:r.$offset})};var V=function(){function u(e){this.$L=Q(e.locale,null,!0),this.parse(e),this.$x=this.$x||e.x||{},this[ne]=!0}var r=u.prototype;return r.parse=function(e){this.$d=function(a){var t=a.date,c=a.utc;if(t===null)return new Date(NaN);if(f.u(t))return new Date;if(t instanceof Date)return new Date(t);if(typeof t=="string"&&!/Z$/i.test(t)){var l=t.match(L);if(l){var p=l[2]-1||0,m=(l[7]||"0").substring(0,3);return c?new Date(Date.UTC(l[1],p,l[3]||1,l[4]||0,l[5]||0,l[6]||0,m)):new Date(l[1],p,l[3]||1,l[4]||0,l[5]||0,l[6]||0,m)}}return new Date(t)}(e),this.init()},r.init=function(){var e=this.$d;this.$y=e.getFullYear(),this.$M=e.getMonth(),this.$D=e.getDate(),this.$W=e.getDay(),this.$H=e.getHours(),this.$m=e.getMinutes(),this.$s=e.getSeconds(),this.$ms=e.getMilliseconds()},r.$utils=function(){return f},r.isValid=function(){return this.$d.toString()!==N},r.isSame=function(e,a){var t=$(e);return this.startOf(a)<=t&&t<=this.endOf(a)},r.isAfter=function(e,a){return $(e)<this.startOf(a)},r.isBefore=function(e,a){return this.endOf(a)<$(e)},r.$g=function(e,a,t){return f.u(e)?this[a]:this.set(t,e)},r.unix=function(){return Math.floor(this.valueOf()/1e3)},r.valueOf=function(){return this.$d.getTime()},r.startOf=function(e,a){var t=this,c=!!f.u(a)||a,l=f.p(e),p=function(I,M){var W=f.w(t.$u?Date.UTC(t.$y,M,I):new Date(t.$y,M,I),t);return c?W:W.endOf(D)},m=function(I,M){return f.w(t.toDate()[I].apply(t.toDate("s"),(c?[0,0,0,0]:[23,59,59,999]).slice(M)),t)},g=this.$W,k=this.$M,b=this.$D,E="set"+(this.$u?"UTC":"");switch(l){case S:return c?p(1,0):p(31,11);case _:return c?p(1,k):p(0,k+1);case F:var j=this.$locale().weekStart||0,U=(g<j?g+7:g)-j;return p(c?b-U:b+(6-U),k);case D:case x:return m(E+"Hours",0);case C:return m(E+"Minutes",1);case v:return m(E+"Seconds",2);case y:return m(E+"Milliseconds",3);default:return this.clone()}},r.endOf=function(e){return this.startOf(e,!1)},r.$set=function(e,a){var t,c=f.p(e),l="set"+(this.$u?"UTC":""),p=(t={},t[D]=l+"Date",t[x]=l+"Date",t[_]=l+"Month",t[S]=l+"FullYear",t[C]=l+"Hours",t[v]=l+"Minutes",t[y]=l+"Seconds",t[w]=l+"Milliseconds",t)[c],m=c===D?this.$D+(a-this.$W):a;if(c===_||c===S){var g=this.clone().set(x,1);g.$d[p](m),g.init(),this.$d=g.set(x,Math.min(this.$D,g.daysInMonth())).$d}else p&&this.$d[p](m);return this.init(),this},r.set=function(e,a){return this.clone().$set(e,a)},r.get=function(e){return this[f.p(e)]()},r.add=function(e,a){var t,c=this;e=Number(e);var l=f.p(a),p=function(k){var b=$(c);return f.w(b.date(b.date()+Math.round(k*e)),c)};if(l===_)return this.set(_,this.$M+e);if(l===S)return this.set(S,this.$y+e);if(l===D)return p(1);if(l===F)return p(7);var m=(t={},t[v]=s,t[C]=h,t[y]=n,t)[l]||1,g=this.$d.getTime()+e*m;return f.w(g,this)},r.subtract=function(e,a){return this.add(-1*e,a)},r.format=function(e){var a=this,t=this.$locale();if(!this.isValid())return t.invalidDate||N;var c=e||"YYYY-MM-DDTHH:mm:ssZ",l=f.z(this),p=this.$H,m=this.$m,g=this.$M,k=t.weekdays,b=t.months,E=t.meridiem,j=function(M,W,H,G){return M&&(M[W]||M(a,c))||H[W].slice(0,G)},U=function(M){return f.s(p%12||12,M,"0")},I=E||function(M,W,H){var G=M<12?"AM":"PM";return H?G.toLowerCase():G};return c.replace(te,function(M,W){return W||function(H){switch(H){case"YY":return String(a.$y).slice(-2);case"YYYY":return f.s(a.$y,4,"0");case"M":return g+1;case"MM":return f.s(g+1,2,"0");case"MMM":return j(t.monthsShort,g,b,3);case"MMMM":return j(b,g);case"D":return a.$D;case"DD":return f.s(a.$D,2,"0");case"d":return String(a.$W);case"dd":return j(t.weekdaysMin,a.$W,k,2);case"ddd":return j(t.weekdaysShort,a.$W,k,3);case"dddd":return k[a.$W];case"H":return String(p);case"HH":return f.s(p,2,"0");case"h":return U(1);case"hh":return U(2);case"a":return I(p,m,!0);case"A":return I(p,m,!1);case"m":return String(m);case"mm":return f.s(m,2,"0");case"s":return String(a.$s);case"ss":return f.s(a.$s,2,"0");case"SSS":return f.s(a.$ms,3,"0");case"Z":return l}return null}(M)||l.replace(":","")})},r.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},r.diff=function(e,a,t){var c,l=this,p=f.p(a),m=$(e),g=(m.utcOffset()-this.utcOffset())*s,k=this-m,b=function(){return f.m(l,m)};switch(p){case S:c=b()/12;break;case _:c=b();break;case T:c=b()/3;break;case F:c=(k-g)/6048e5;break;case D:c=(k-g)/864e5;break;case C:c=k/h;break;case v:c=k/s;break;case y:c=k/n;break;default:c=k}return t?c:f.a(c)},r.daysInMonth=function(){return this.endOf(_).$D},r.$locale=function(){return d[this.$L]},r.locale=function(e,a){if(!e)return this.$L;var t=this.clone(),c=Q(e,a,!0);return c&&(t.$L=c),t},r.clone=function(){return f.w(this.$d,this)},r.toDate=function(){return new Date(this.valueOf())},r.toJSON=function(){return this.isValid()?this.toISOString():null},r.toISOString=function(){return this.$d.toISOString()},r.toString=function(){return this.$d.toUTCString()},u}(),oe=V.prototype;return $.prototype=oe,[["$ms",w],["$s",y],["$m",v],["$H",C],["$W",D],["$M",_],["$y",S],["$D",x]].forEach(function(u){oe[u[1]]=function(r){return this.$g(r,u[0],u[1])}}),$.extend=function(u,r){return u.$i||(u(r,V,$),u.$i=!0),$},$.locale=Q,$.isDayjs=se,$.unix=function(u){return $(1e3*u)},$.en=d[O],$.Ls=d,$.p={},$})})(ve);var Ie=ve.exports;const Ae=ke(Ie);var Ne={size:"1em",strokeWidth:4,strokeLinecap:"round",strokeLinejoin:"round",rtl:!1,theme:"outline",colors:{outline:{fill:"#333",background:"transparent"},filled:{fill:"#333",background:"#FFF"},twoTone:{fill:"#333",twoTone:"#2F88FF"},multiColor:{outStrokeColor:"#333",outFillColor:"#2F88FF",innerStrokeColor:"#FFF",innerFillColor:"#43CCF8"}},prefix:"i"};function Ee(){return"icon-"+((1+Math.random())*4294967296|0).toString(16).substring(1)}function Be(o,i,n){var s=typeof i.fill=="string"?[i.fill]:i.fill||[],h=[],w=i.theme||n.theme;switch(w){case"outline":h.push(typeof s[0]=="string"?s[0]:"currentColor"),h.push("none"),h.push(typeof s[0]=="string"?s[0]:"currentColor"),h.push("none");break;case"filled":h.push(typeof s[0]=="string"?s[0]:"currentColor"),h.push(typeof s[0]=="string"?s[0]:"currentColor"),h.push("#FFF"),h.push("#FFF");break;case"two-tone":h.push(typeof s[0]=="string"?s[0]:"currentColor"),h.push(typeof s[1]=="string"?s[1]:n.colors.twoTone.twoTone),h.push(typeof s[0]=="string"?s[0]:"currentColor"),h.push(typeof s[1]=="string"?s[1]:n.colors.twoTone.twoTone);break;case"multi-color":h.push(typeof s[0]=="string"?s[0]:"currentColor"),h.push(typeof s[1]=="string"?s[1]:n.colors.multiColor.outFillColor),h.push(typeof s[2]=="string"?s[2]:n.colors.multiColor.innerStrokeColor),h.push(typeof s[3]=="string"?s[3]:n.colors.multiColor.innerFillColor);break}return{size:i.size||n.size,strokeWidth:i.strokeWidth||n.strokeWidth,strokeLinecap:i.strokeLinecap||n.strokeLinecap,strokeLinejoin:i.strokeLinejoin||n.strokeLinejoin,colors:h,id:o}}var Ye=Symbol("icon-context");function ze(o,i,n){var s={name:"icon-"+o,props:["size","strokeWidth","strokeLinecap","strokeLinejoin","theme","fill","spin"],setup:function(w){var y=Ee(),v=_e(Ye,Ne);return function(){var C=w.size,D=w.strokeWidth,F=w.strokeLinecap,_=w.strokeLinejoin,T=w.theme,S=w.fill,x=w.spin,N=Be(y,{size:C,strokeWidth:D,strokeLinecap:F,strokeLinejoin:_,theme:T,fill:S},v),L=[v.prefix+"-icon"];return L.push(v.prefix+"-icon-"+o),i&&v.rtl&&L.push(v.prefix+"-icon-rtl"),x&&L.push(v.prefix+"-icon-spin"),B("span",{class:L.join(" ")},[n(N)])}}};return s}const Xe=ze("local-two",!1,function(o){return B("svg",{width:o.size,height:o.size,viewBox:"0 0 48 48",fill:"none"},[B("path",{d:"M24 44C24 44 39 32 39 19C39 10.7157 32.2843 4 24 4C15.7157 4 9 10.7157 9 19C9 32 24 44 24 44Z",fill:o.colors[1],stroke:o.colors[0],"stroke-width":o.strokeWidth,"stroke-linejoin":o.strokeLinejoin},null),B("path",{d:"M24 25C27.3137 25 30 22.3137 30 19C30 15.6863 27.3137 13 24 13C20.6863 13 18 15.6863 18 19C18 22.3137 20.6863 25 24 25Z",fill:o.colors[3],stroke:o.colors[2],"stroke-width":o.strokeWidth,"stroke-linejoin":o.strokeLinejoin},null)])}),Ue={class:"p-3"},He=me({__name:"EmptyView",props:{msg:{type:String,required:!1}},setup(o){const i=Me(be);function n(){Se.openConfigPage(i.widgetParams.id)}return(s,h)=>(ee(),Ce("div",{class:"empty-key flex w-full text-center h-full items-center justify-center cursor-pointer",onClick:n},[K("p",Ue,[we(s.$slots,"default",{},()=>[ae(De(o.msg),1)],!0)])]))}}),Pe=(o,i)=>{const n=o.__vccOpts||o;for(const[s,h]of i)n[s]=h;return n},fe=Pe(He,[["__scopeId","data-v-46f7e593"]]),qe={class:"flex flex-col gap-4 items-center"},Ke=K("span",null,"点击设置 和风天气 API KEY",-1),Qe={class:"flex flex-wrap gap-1 items-center justify-center"},Ve=K("span",null,null,-1),et=me({__name:"QWeatherWrapper",props:{errorMsg:{type:String,required:!1},loading:{type:Boolean,required:!1},checkApiKey:{type:Boolean,required:!1,default:!0}},setup(o){const i=P("apiKey","");function n(){le.openUrl("https://www.bilibili.com/video/BV1XQ4y1v7wS/?share_source=copy_web&vd_source=d97a783ed15a74f48591bd6098a158a4&t=39",{external:!0})}function s(){le.openUrl("https://console.qweather.com/#/console",{external:!0})}return(h,w)=>{const y=Oe,v=xe("widget-wrapper");return ee(),ie(v,null,{default:Z(()=>[o.checkApiKey&&!Fe(i)?(ee(),ie(fe,{key:0},{default:Z(()=>[K("div",qe,[Ke,K("div",Qe,[B(y,{class:"w-20",type:"primary",onClick:ce(n,["stop"])},{default:Z(()=>[ae(" 视频教程 ")]),_:1}),Ve,B(y,{class:"w-20",type:"warning",onClick:ce(s,["stop"])},{default:Z(()=>[ae(" 申请地址 ")]),_:1})])])]),_:1})):o.errorMsg?(ee(),ie(fe,{key:1,msg:o.errorMsg},null,8,["msg"])):we(h.$slots,"default",{key:2})]),_:3})}}});class Ge{static getBackgroundClass(i){return this.between(i,101,104)||this.between(i,151,153)?"city-weather-cloudy":this.between(i,101,399)?"city-weather-rain":this.between(i,400,499)?"city-weather-snow":this.between(i,500,515)?"city-weather-haze":"city-weather-sun"}static between(i,n,s){return i>=n&&i<=s}}const q=We.create({});q.interceptors.response.use(o=>{if(o.status==200){const i=o.data.code;let n="未知错误";return i!=200?(i==204?n="请求成功，但你查询的地区暂时没有你需要的数据。":i==400?n="请求错误，可能包含错误的请求参数或缺少必选的请求参数。":i==401?n="认证失败，可能使用了错误的KEY、数字签名错误、KEY的类型错误":i==402?n="超过访问次数或余额不足以支持继续访问服务":i==403?n="无访问权限，可能是绑定的PackageName、BundleID、域名IP地址不一致":i==404?n="查询的数据或地区不存在":i==429?n="超过限定的QPM（每分钟访问次数）":i==500&&(n="无响应或超时，接口服务异常请联系和风天气"),Promise.reject(new pe(n,i))):Promise.resolve(o.data)}else return Promise.reject(new pe("未知错误","未知错误"))},o=>Promise.reject(o));class pe extends Error{constructor(n,s){super(n);ue(this,"code");this.code=s}}class X{static async weatherNow(i,n,s=R){return await q.get(`https://devapi.qweather.com/v7/weather/now?location=${i}&key=${n}&lang=${s}`)}static async indices(i,n,s=1,h=R){return await q.get(`https://devapi.qweather.com/v7/indices/${s}d?type=0&location=${i}&key=${n}&lang=${h}`)}static async weather3d(i,n,s=R){return await q.get(`https://devapi.qweather.com/v7/weather/3d?location=${i}&key=${n}&lang=${s}`)}static async air5d(i,n,s=R){return await q.get(`https://devapi.qweather.com/v7/air/5d?location=${i}&key=${n}&lang=${s}`)}}function tt(o){const i=P("locationId",de.id),n=P("selectLocation",de),s=P("apiKey",""),h=A(Ae()),w=A(""),y=A(),v=A(!1),C=A(),D=A(),F=A(),_=Le(),T=P("selectedUnit","C"),S=J(()=>T.value=="C"?"°C":"°F"),x=J(()=>{var d;return(d=y.value)==null?void 0:d.now}),N=J(()=>{var d;return y.value?T.value=="F"?Number(y.value.now.temp)*9/5+32:(d=y.value)==null?void 0:d.now.temp:0}),L=J(()=>{var d;return _.widgetTheme.value.useGlobalTheme?"widget-default":Ge.getBackgroundClass(Number.parseInt(((d=x.value)==null?void 0:d.icon)??"100"))}),te=()=>{X.indices(n.value.id,s.value).then(d=>{C.value=d.daily[Math.floor(Math.random()*d.daily.length)]})},re=()=>{X.weather3d(n.value.id,s.value).then(d=>{F.value=d})},Y=()=>{X.indices(n.value.id,s.value).then(d=>{C.value=d.daily[Math.floor(Math.random()*d.daily.length)]})},z=()=>{w.value="",v.value=!0,o!=null&&o.useIndex&&te(),o!=null&&o.useAir&&Y(),o!=null&&o.useWeather3d&&re(),X.weatherNow(n.value.id,s.value).then(d=>{y.value=d}).catch(d=>{w.value=d.message}).finally(()=>v.value=!1)},O=je(z,1e3);return he(s,()=>{O()}),he(n,()=>{O()}),Te(()=>{z()},60*60*1e3,{immediate:!0,immediateCallback:!0}),{locationId:i,selectLocation:n,apiKey:s,air5dResponse:D,backgroundClass:L,now:h,temperature:N,weatherData:x,dailyIndex:C,unitText:S,loading:v,weather3dResponse:F,update:z,errorMsg:w,responseData:y}}export{Xe as L,et as _,Pe as a,Ae as d,tt as u};
